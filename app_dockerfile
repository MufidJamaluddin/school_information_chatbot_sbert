## BUILD STAGE

FROM golang:1.21 AS build

WORKDIR /app

COPY go.mod go.sum ./

RUN go mod download

COPY main.go .

COPY src/ ./src
COPY docs/ ./docs

RUN go mod tidy

RUN CGO_ENABLED=0 go build -o app

## RUNNING STAGE

FROM scratch

WORKDIR /app
COPY --from=build /app/app ./

COPY dist/ ./dist

EXPOSE $APP_PORT

CMD ["./app"]
